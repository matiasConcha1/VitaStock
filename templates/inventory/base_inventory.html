{% extends "layouts/base.html" %}
{% load static %}

{% block extrastyle %}
  {{ block.super }}
  <link rel="stylesheet" href="{% static 'assets/css/inventory-wallpaper.css' %}">
{% endblock extrastyle %}

{% block content %}
<div class="container-fluid py-4">
  {% include "partials/messages.html" %}

  <div class="row mb-3">
    <div class="col-12 d-flex justify-content-between align-items-center">
      <h4 class="mb-0">{% block page_title %}{% endblock page_title %}</h4>
      <div>
        {% block header_actions %}{% endblock header_actions %}
      </div>
    </div>
  </div>

  {% block inventory_content %}{% endblock inventory_content %}
</div>
{% endblock content %}

{% block extra_js %}
  {{ block.super }}
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script>
    (function() {
      const levelToIcon = {
        success: 'success',
        info: 'info',
        warning: 'warning',
        error: 'error',
        debug: 'info'
      };
      const prefersDark = document.body.classList.contains('theme-dark');
      const swalTheme = prefersDark ? {
        background: '#141821',
        color: '#e7e9ed',
        confirmButtonColor: '#6366f1'
      } : {
        background: '#fff',
        color: '#111',
        confirmButtonColor: '#4f46e5'
      };
      {% if messages %}
      const flashMessages = [
        {% for message in messages %}
          {text: "{{ message|escapejs }}", level: "{{ message.tags|default:'info' }}"}{% if not forloop.last %},{% endif %}
        {% endfor %}
      ];
      flashMessages.forEach(msg => {
        Swal.fire({
          text: msg.text,
          icon: levelToIcon[msg.level] || 'info',
          confirmButtonText: 'OK',
          background: swalTheme.background,
          color: swalTheme.color,
          confirmButtonColor: swalTheme.confirmButtonColor,
          customClass: {popup: 'swal2-shadow'}
        });
      });
      {% endif %}
    })();
  </script>
{% endblock extra_js %}
